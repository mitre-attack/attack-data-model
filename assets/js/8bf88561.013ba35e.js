"use strict";(globalThis.webpackChunkdocusaurus=globalThis.webpackChunkdocusaurus||[]).push([[565],{1367(e,t,n){n.d(t,{A:()=>s});n(6540);var a=n(7293),o=n(4848);function s(){return(0,o.jsx)(a.A,{type:"warning",title:"\ud83d\udea7 Work in Progress",icon:"\u26a0\ufe0f",children:"This document is a work in progress. Content may change, and some sections may be incomplete."})}},2648(e,t,n){n.r(t),n.d(t,{assets:()=>S,contentTitle:()=>T,default:()=>w,frontMatter:()=>v,metadata:()=>a,toc:()=>_});const a=JSON.parse('{"id":"principles/schema-design","title":"Schema Design Principles","description":"The schema layer is the foundation that enables runtime validation in the ATT&CK Data Model.","source":"@site/docs/principles/schema-design.mdx","sourceDirName":"principles","slug":"/principles/schema-design","permalink":"/attack-data-model/docs/principles/schema-design","draft":false,"unlisted":false,"editUrl":"https://github.com/mitre-attack/attack-data-model/tree/main/docusaurus/docs/principles/schema-design.mdx","tags":[],"version":"current","lastUpdatedBy":"Sean Sica","lastUpdatedAt":1770752995000,"frontMatter":{},"sidebar":"documentationSidebar","previous":{"title":"Detections, Data Sources, and STIX","permalink":"/attack-data-model/docs/principles/attack-detections"},"next":{"title":"Architecture and Design Trade-offs","permalink":"/attack-data-model/docs/principles/trade-offs"}}');var o=n(4848),s=n(8453),i=n(1367),c=n(6540),r=n(5687),l=n(7792),d=n(6858),h=n(2492),m=n(8445),u=n(6844),p=n(1004),x=n(3893),f=n(827),y=n(8697),g=n(3324);const j={container:"container_Yyjm",containerFullscreen:"containerFullscreen_mVXZ",header:"header_HwcS",headerContent:"headerContent_Iow4",fullscreenButton:"fullscreenButton_Dt5b",contentWrapper:"contentWrapper_Df4m",canvasContainer:"canvasContainer_FRzx",canvasContainerFullscreen:"canvasContainerFullscreen_CZF0",canvasGrab:"canvasGrab_Di4f",canvasGrabbing:"canvasGrabbing_rhoO",canvasInner:"canvasInner_cJMy",canvasInnerPanning:"canvasInnerPanning_U4kw",panHint:"panHint_xFHS",svg:"svg_dkdk",connection:"connection_n0mv",connectionLabel:"connectionLabel_ncQ3",node:"node_C9nb",nodeDimmed:"nodeDimmed_K4Hr",nodeActive:"nodeActive_yvP0",nodeDragging:"nodeDragging_c9ta",nodeGrab:"nodeGrab_LJon",nodeIcon:"nodeIcon_ivgi",nodeName:"nodeName_lO4W",nodeType:"nodeType_MEEU",detailsPanel:"detailsPanel_crJ_",detailsHeader:"detailsHeader_tR73",detailsIconWrapper:"detailsIconWrapper_bmIg",detailsTitle:"detailsTitle_UfVG",detailsStixType:"detailsStixType_T0WT",connectionsSection:"connectionsSection_UKaA",sectionHeader:"sectionHeader_hZXr",sectionDot:"sectionDot_uiQc",sectionDotGreen:"sectionDotGreen_k5Ne",sectionDotBlue:"sectionDotBlue_zK7R",connectionsList:"connectionsList_dMbp",connectionItem:"connectionItem_Awam",connectionItemOutbound:"connectionItemOutbound_EXda",connectionItemInbound:"connectionItemInbound_yZoy",connectionHeader:"connectionHeader_CdFX",connectionType:"connectionType_vFbQ",connectionTypeOutbound:"connectionTypeOutbound_LToO",connectionTypeInbound:"connectionTypeInbound_ELBV",connectionTarget:"connectionTarget__PnL",emptyState:"emptyState_VtlF",defaultState:"defaultState_MIXd",defaultStateIcon:"defaultStateIcon_LO2z",defaultStateText:"defaultStateText_tCVG",legendGrid:"legendGrid_tlyd",legendItem:"legendItem_lbZx",legendColor:"legendColor_uBrM",fullscreenOverlay:"fullscreenOverlay_HmnR",rotatePrompt:"rotatePrompt_EMPI",rotatePromptContent:"rotatePromptContent_lZnk",rotateIcon:"rotateIcon_TgOC",rotateAnimation:"rotateAnimation_hHLe",rotatePromptTitle:"rotatePromptTitle_koGk",rotatePromptText:"rotatePromptText_OLP5"},b=()=>{const[e,t]=(0,c.useState)(null),[n,a]=(0,c.useState)([]),[s,i]=(0,c.useState)(null),[b,v]=(0,c.useState)(!1),[T,S]=(0,c.useState)({x:0,y:0}),[_,C]=(0,c.useState)(!1),[w,N]=(0,c.useState)({matrix:{x:15,y:10},tactic:{x:50,y:10},technique:{x:50,y:30},subtechnique:{x:85,y:30},asset:{x:15,y:30},mitigation:{x:15,y:50},detectionStrategy:{x:85,y:50},analytic:{x:85,y:70},dataComponent:{x:85,y:95},dataSource:{x:45,y:95},group:{x:15,y:70},campaign:{x:15,y:95},software:{x:50,y:70}}),[k,A]=(0,c.useState)(!1),[I,D]=(0,c.useState)(null),[P,$]=(0,c.useState)(!1),[L,M]=(0,c.useState)(!1),[E,q]=(0,c.useState)(!1),X=(0,c.useRef)(null),H=(0,c.useRef)(null),R=(0,c.useRef)({x:0,y:0}),K=(0,c.useRef)({x:0,y:0}),G=(0,c.useRef)(null),O=(0,c.useRef)(null);(0,c.useEffect)(()=>{const e=()=>{const e=window.innerWidth<=1024,t=window.innerHeight>window.innerWidth;M(e),q(e&&t)};return e(),window.addEventListener("resize",e),window.addEventListener("orientationchange",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}},[]),(0,c.useEffect)(()=>{const e=e=>{"Escape"===e.key&&_&&C(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[_]),(0,c.useEffect)(()=>{const e=e=>{b&&e.preventDefault()};return b?(document.body.style.overflow="hidden",document.addEventListener("touchmove",e,{passive:!1})):document.body.style.overflow="",()=>{document.body.style.overflow="",document.removeEventListener("touchmove",e)}},[b]);const B={matrix:{id:"matrix",name:"Matrix",stixType:"x-mitre-matrix",icon:r.A,color:"#3b82f6"},tactic:{id:"tactic",name:"Tactic",stixType:"x-mitre-tactic",icon:l.A,color:"#3b82f6"},technique:{id:"technique",name:"Technique",stixType:"attack-pattern",icon:d.A,color:"#ef4444"},subtechnique:{id:"subtechnique",name:"Sub-technique",stixType:"attack-pattern",icon:d.A,color:"#f87171"},mitigation:{id:"mitigation",name:"Mitigation",stixType:"course-of-action",icon:h.A,color:"#22c55e"},detectionStrategy:{id:"detectionStrategy",name:"Detection Strategy",stixType:"x-mitre-detection-strategy",icon:m.A,color:"#eab308"},analytic:{id:"analytic",name:"Analytic",stixType:"x-mitre-analytic",icon:u.A,color:"#eab308"},dataComponent:{id:"dataComponent",name:"Data Component",stixType:"x-mitre-data-component",icon:p.A,color:"#ca8a04"},dataSource:{id:"dataSource",name:"Data Source (deprecated)",stixType:"x-mitre-data-source",icon:p.A,color:"#92400e"},group:{id:"group",name:"Group",stixType:"intrusion-set",icon:x.A,color:"#f97316"},campaign:{id:"campaign",name:"Campaign",stixType:"campaign",icon:l.A,color:"#f97316"},software:{id:"software",name:"Software",stixType:"malware/tool",icon:f.A,color:"#ea580c"},asset:{id:"asset",name:"Asset",stixType:"x-mitre-asset",icon:p.A,color:"#a855f7"}},W=[{from:"matrix",to:"tactic",label:"tactic_refs",type:"property",color:"#60a5fa"},{from:"technique",to:"tactic",label:"kill_chain_phases",type:"property",color:"#60a5fa"},{from:"subtechnique",to:"technique",label:"subtechnique-of",type:"relationship",color:"#f87171"},{from:"group",to:"technique",label:"uses",type:"relationship",color:"#fb923c"},{from:"software",to:"technique",label:"uses",type:"relationship",color:"#fb923c"},{from:"campaign",to:"technique",label:"uses",type:"relationship",color:"#fb923c"},{from:"group",to:"software",label:"uses",type:"relationship",color:"#fb923c"},{from:"campaign",to:"software",label:"uses",type:"relationship",color:"#fb923c"},{from:"campaign",to:"group",label:"attributed-to",type:"relationship",color:"#fb923c"},{from:"mitigation",to:"technique",label:"mitigates",type:"relationship",color:"#4ade80"},{from:"detectionStrategy",to:"technique",label:"detects",type:"relationship",color:"#facc15"},{from:"detectionStrategy",to:"analytic",label:"analytic_refs",type:"property",color:"#facc15"},{from:"analytic",to:"dataComponent",label:"log_source_refs",type:"property",color:"#facc15"},{from:"dataComponent",to:"dataSource",label:"x_mitre_data_source_ref (deprecated)",type:"property",color:"#92400e",dashed:!0},{from:"dataComponent",to:"technique",label:"detects (deprecated)",type:"relationship",color:"#facc15",dashed:!0},{from:"technique",to:"asset",label:"targets",type:"relationship",color:"#c084fc"}],F=(n,o)=>{if(o.stopPropagation(),!s)if(e===n)t(null),a([]);else{t(n);const e=W.filter(e=>e.from===n||e.to===n);a(e)}},z=(e,t)=>{if(t.preventDefault(),t.stopPropagation(),!X.current)return;const n=X.current.getBoundingClientRect(),a=w[e],o=t.touches?t.touches[0].clientX:t.clientX,s=t.touches?t.touches[0].clientY:t.clientY,c=n.left+a.x/100*n.width,r=n.top+a.y/100*n.height;R.current={x:o-c,y:s-r},t.touches?O.current=setTimeout(()=>{$(!0),i(e)},500):i(e)},Y=e=>{if(s&&X.current){const t=X.current.getBoundingClientRect(),n=e.touches?e.touches[0].clientX:e.clientX,a=e.touches?e.touches[0].clientY:e.clientY,o=(n-t.left-R.current.x)/t.width*100,i=(a-t.top-R.current.y)/t.height*100,c=Math.max(5,Math.min(95,o)),r=Math.max(5,Math.min(95,i));N(e=>({...e,[s]:{x:c,y:r}}))}else if(b){const t=e.touches?e.touches[0].clientX:e.clientX,n=e.touches?e.touches[0].clientY:e.clientY,a=t-K.current.x,o=n-K.current.y;S({x:T.x+a,y:T.y+o}),K.current={x:t,y:n}}},U=()=>{i(null),v(!1),$(!1),G.current&&(clearTimeout(G.current),G.current=null),O.current&&(clearTimeout(O.current),O.current=null)},V=e=>{if(e.target===e.currentTarget||"svg"===e.target.tagName)if("mousedown"===e.type)v(!0),K.current={x:e.clientX,y:e.clientY};else if("touchstart"===e.type){const t=e.touches[0];K.current={x:t.clientX,y:t.clientY},A(!0),I&&clearTimeout(I),G.current=setTimeout(()=>{v(!0),A(!1)},500)}},Z=e?{node:B[J=e],inbound:W.filter(e=>e.to===J),outbound:W.filter(e=>e.from===J)}:null;var J;if(E)return(0,o.jsx)("div",{className:j.rotatePrompt,children:(0,o.jsxs)("div",{className:j.rotatePromptContent,children:[(0,o.jsx)("div",{className:j.rotateIcon,children:(0,o.jsxs)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("rect",{x:"5",y:"2",width:"14",height:"20",rx:"2",ry:"2"}),(0,o.jsx)("line",{x1:"12",y1:"18",x2:"12.01",y2:"18"})]})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{className:j.rotatePromptTitle,children:"Please Rotate Your Device"}),(0,o.jsx)("p",{className:j.rotatePromptText,children:"This visualization is best viewed in landscape mode for optimal viewing experience."})]})]})});const Q=(0,o.jsxs)("div",{className:`${j.container} ${_?j.containerFullscreen:""}`,children:[(0,o.jsxs)("div",{className:j.header,children:[(0,o.jsxs)("div",{className:j.headerContent,children:[(0,o.jsx)("h1",{children:"ATT&CK STIX Architecture"}),(0,o.jsx)("p",{children:"Click nodes to explore relationships \u2022 Drag nodes to rearrange \u2022 Drag canvas to pan"})]}),!L&&(0,o.jsx)("button",{onClick:()=>C(!_),className:j.fullscreenButton,title:_?"Exit fullscreen (Esc)":"Enter fullscreen",children:_?(0,o.jsx)(y.A,{size:24}):(0,o.jsx)(g.A,{size:24})})]}),(0,o.jsxs)("div",{className:j.contentWrapper,children:[(0,o.jsx)("div",{ref:X,className:`${j.canvasContainer} ${_?j.canvasContainerFullscreen:""} ${s||b?j.canvasGrabbing:j.canvasGrab}`,style:{touchAction:b||s?"none":"pan-y"},onMouseMove:Y,onMouseUp:U,onMouseLeave:U,onMouseDown:V,onClick:e=>{b||e.target!==e.currentTarget&&"svg"!==e.target.tagName||(t(null),a([]))},onTouchStart:V,onTouchMove:Y,onTouchEnd:e=>{(()=>{G.current&&(clearTimeout(G.current),G.current=null),I&&clearTimeout(I);const e=setTimeout(()=>A(!1),1e3);D(e)})(),U()},children:(0,o.jsxs)("div",{className:`${j.canvasInner} ${b?j.canvasInnerPanning:""}`,style:{transform:`translate(${T.x}px, ${T.y}px)`},children:[k&&(0,o.jsx)("div",{className:j.panHint,children:"Tap and hold to pan the canvas"}),(0,o.jsxs)("svg",{className:j.svg,children:[(0,o.jsx)("defs",{children:W.map((e,t)=>(0,o.jsx)("marker",{id:`arrowhead-${t}`,markerWidth:"6",markerHeight:"6",refX:"5",refY:"3",orient:"auto",children:(0,o.jsx)("polygon",{points:"0 0, 6 3, 0 6",fill:e.color})},t))}),W.map((e,t)=>{const a=w[e.from],s=w[e.to],i=(c=e,0===n.length||n.some(e=>e.from===c.from&&e.to===c.to));var c;const r=s.x-a.x,l=s.y-a.y,d=Math.atan2(l,r),h=a.x+5*Math.cos(d),m=a.y+5*Math.sin(d),u=s.x-5*Math.cos(d),p=s.y-5*Math.sin(d);return(0,o.jsxs)("g",{opacity:i?1:.2,children:[(0,o.jsx)("line",{x1:`${h}%`,y1:`${m}%`,x2:`${u}%`,y2:`${p}%`,stroke:e.color,strokeWidth:i?3:2,strokeDasharray:e.dashed?"5,5":"0",markerEnd:`url(#arrowhead-${t})`,className:j.connection}),i&&(0,o.jsx)("text",{x:(a.x+s.x)/2+"%",y:(a.y+s.y)/2+"%",className:j.connectionLabel,textAnchor:"middle",dy:"-5",children:e.label})]},t)})]}),Object.entries(B).map(([t,a])=>{const c=a.icon,r=(t=>0===n.length||n.some(e=>e.from===t||e.to===t)||t===e)(t),l=t===e,d=t===s,h=w[t],m=[j.node,!r&&j.nodeDimmed,l&&j.nodeActive,d&&j.nodeDragging,!d&&j.nodeGrab].filter(Boolean).join(" ");return(0,o.jsxs)("div",{className:m,style:{left:`${h.x}%`,top:`${h.y}%`,backgroundColor:a.color,zIndex:d?30:l?20:10},onMouseDown:e=>z(t,e),onClick:e=>!s&&F(t,e),onTouchStart:e=>z(t,e),onTouchEnd:e=>((e,t)=>{O.current&&(clearTimeout(O.current),O.current=null),P||s||(t.preventDefault(),t.stopPropagation(),F(e,t)),$(!1),i(null)})(t,e),children:[(0,o.jsx)(c,{className:j.nodeIcon}),(0,o.jsx)("div",{className:j.nodeName,children:a.name}),(0,o.jsx)("div",{className:j.nodeType,children:a.stixType})]},t)})]})}),(0,o.jsx)("div",{className:j.detailsPanel,children:Z?(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:j.detailsHeader,children:[c.createElement(Z.node.icon,{className:j.detailsIconWrapper,style:{backgroundColor:Z.node.color}}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{className:j.detailsTitle,children:Z.node.name}),(0,o.jsx)("code",{className:j.detailsStixType,children:Z.node.stixType})]})]}),Z.outbound.length>0&&(0,o.jsxs)("div",{className:j.connectionsSection,children:[(0,o.jsxs)("h3",{className:j.sectionHeader,children:[(0,o.jsx)("span",{className:`${j.sectionDot} ${j.sectionDotGreen}`}),"Outgoing Connections (",Z.outbound.length,")"]}),(0,o.jsx)("div",{className:j.connectionsList,children:Z.outbound.map((e,t)=>{const n=e.label.match(/^(.+?)(\s*\([^)]+\))?\s*$/),a=n?n[1]:e.label,s=n&&n[2]?n[2].trim():null;return(0,o.jsxs)("div",{className:`${j.connectionItem} ${j.connectionItemOutbound}`,children:[(0,o.jsxs)("div",{className:j.connectionHeader,children:[(0,o.jsxs)("span",{className:j.connectionLabel,children:[a,s&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("br",{}),(0,o.jsx)("span",{style:{fontSize:"0.75rem",opacity:.8},children:s})]})]}),(0,o.jsx)("span",{className:`${j.connectionType} ${j.connectionTypeOutbound}`,children:e.type})]}),(0,o.jsxs)("div",{className:j.connectionTarget,children:["\u2192 ",B[e.to].name]})]},t)})})]}),Z.inbound.length>0&&(0,o.jsxs)("div",{className:j.connectionsSection,children:[(0,o.jsxs)("h3",{className:j.sectionHeader,children:[(0,o.jsx)("span",{className:`${j.sectionDot} ${j.sectionDotBlue}`}),"Incoming Connections (",Z.inbound.length,")"]}),(0,o.jsx)("div",{className:j.connectionsList,children:Z.inbound.map((e,t)=>{const n=e.label.match(/^(.+?)(\s*\([^)]+\))?\s*$/),a=n?n[1]:e.label,s=n&&n[2]?n[2].trim():null;return(0,o.jsxs)("div",{className:`${j.connectionItem} ${j.connectionItemInbound}`,children:[(0,o.jsxs)("div",{className:j.connectionHeader,children:[(0,o.jsxs)("span",{className:j.connectionLabel,children:[a,s&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("br",{}),(0,o.jsx)("span",{style:{fontSize:"0.75rem",opacity:.8},children:s})]})]}),(0,o.jsx)("span",{className:`${j.connectionType} ${j.connectionTypeInbound}`,children:e.type})]}),(0,o.jsxs)("div",{className:j.connectionTarget,children:["\u2190 ",B[e.from].name]})]},t)})})]}),0===Z.inbound.length&&0===Z.outbound.length&&(0,o.jsx)("div",{className:j.emptyState,children:(0,o.jsx)("p",{children:"No direct connections"})})]}):(0,o.jsxs)("div",{className:j.defaultState,children:[(0,o.jsx)(r.A,{className:j.defaultStateIcon}),(0,o.jsx)("p",{className:j.defaultStateText,children:"Click on any node to see its connections"}),(0,o.jsx)("div",{className:j.legendGrid,children:[{color:"#3b82f6",label:"Structure"},{color:"#ef4444",label:"Attack Patterns"},{color:"#f97316",label:"Actors & Tools"},{color:"#22c55e",label:"Defense"},{color:"#eab308",label:"Detection"},{color:"#a855f7",label:"Targets"}].map((e,t)=>(0,o.jsxs)("div",{className:j.legendItem,children:[(0,o.jsx)("div",{className:j.legendColor,style:{backgroundColor:e.color}}),(0,o.jsx)("span",{children:e.label})]},t))})]})})]})]});return _?(0,o.jsx)("div",{ref:H,className:j.fullscreenOverlay,onClick:e=>{e.target===H.current&&C(!1)},children:Q}):Q},v={},T="Schema Design Principles",S={},_=[{value:"Core Design Philosophy",id:"core-design-philosophy",level:2},{value:"Schema Stack",id:"schema-stack",level:2},{value:"ATT&amp;CK STIX Architecture",id:"attck-stix-architecture",level:2},{value:"Schema Tiers",id:"schema-tiers",level:2},{value:"Why base schemas exist",id:"why-base-schemas-exist",level:3}];function C(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"schema-design-principles",children:"Schema Design Principles"})}),"\n",(0,o.jsx)(i.A,{}),"\n",(0,o.jsx)(t.p,{children:"The schema layer is the foundation that enables runtime validation in the ATT&CK Data Model.\r\nThe design of these schemas reflects careful consideration of competing concerns:\r\nSTIX compliance, ATT&CK domain rules, and TypeScript integration.\r\nThis page explores the principles of our schema design decisions."}),"\n",(0,o.jsx)(t.h2,{id:"core-design-philosophy",children:"Core Design Philosophy"}),"\n",(0,o.jsx)(t.p,{children:"Rather than maintaining separate documentation about data format requirements, the schemas encode these requirements directly.\r\nThis ensures that documentation stays synchronized with implementation and provides immediate feedback when requirements change."}),"\n",(0,o.jsx)(t.p,{children:"This approach means that anyone using the schemas we provide automatically has access to ATT&CK requirements through validation feedback,\r\nrather than needing to consult separate documentation."}),"\n",(0,o.jsx)(t.h2,{id:"schema-stack",children:"Schema Stack"}),"\n",(0,o.jsx)(t.p,{children:"ATT&CK schemas reflect the nature of STIX + ATT&CK requirements.\r\nThis enables them to be built on a solid foundation while supporting interesting use cases on top of it."}),"\n",(0,o.jsx)(t.p,{children:"This diagram reflects how higher-level consumers rely on TypeScript types and the schema layer,\r\nwhich itself composes ATT&CK-specific rules on top of the STIX core."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-text",children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502 Application / Consumers                                       \u2502\r\n\u2502  - UI and validation                                          \u2502\r\n\u2502  - e.g. ATT&CK Workbench, ATT&CK Navigator                    \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n                            \u2191\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502 TypeScript Types & Runtime APIs                               \u2502\r\n\u2502  - static types, helpers, IDE integration                     \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n                            \u2191\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502 Schema Layer (zod)                                            \u2502\r\n\u2502  - ATT&CK Spec as code                                        \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n                            \u2191\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502 ATT&CK Specific Requirements                                  \u2502\r\n\u2502  - x_mitre_* properties, ATT&CK-specific objects              \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n                            \u2191\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502 STIX Core Requirements                                        \u2502\r\n\u2502  - id, type, spec_version, created, modified, etc.            \u2502\r\n\u2502  - solid foundation to build on                               \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,o.jsx)(t.hr,{}),"\n",(0,o.jsx)(t.h2,{id:"attck-stix-architecture",children:"ATT&CK STIX Architecture"}),"\n",(0,o.jsx)(t.p,{children:"The following interactive diagram shows how different ATT&CK STIX object types relate to each other. Hover over or click any node to explore its connections."}),"\n",(0,o.jsx)(b,{}),"\n",(0,o.jsx)(t.hr,{}),"\n",(0,o.jsx)(t.h2,{id:"schema-tiers",children:"Schema Tiers"}),"\n",(0,o.jsxs)(t.p,{children:["Each ATT&CK object type that supports ",(0,o.jsx)(t.a,{href:"https://zod.dev/refinements",children:"refinements"})," exports up to three schema tiers,\r\neach serving a different purpose:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-text",children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502  campaignSchema              (full validation)              \u2502\r\n\u2502  \u251c\u2500\u2500 Object shape            (fields, types, strictness)    \u2502\r\n\u2502  \u2514\u2500\u2500 Refinements             (cross-field business rules)   \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n                          \u25b2\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502  campaignBaseSchema          (shape only, no refinements)   \u2502\r\n\u2502  \u2514\u2500\u2500 Supports .partial(), .pick(), .omit()                  \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n                          \u25b2\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502  campaignPartialSchema       (all fields optional)          \u2502\r\n\u2502  \u251c\u2500\u2500 Derived from base via .partial()                       \u2502\r\n\u2502  \u2514\u2500\u2500 Refinements re-applied (partial-safe)                  \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,o.jsxs)(t.table,{children:[(0,o.jsx)(t.thead,{children:(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.th,{children:"Tier"}),(0,o.jsx)(t.th,{children:"Example"}),(0,o.jsx)(t.th,{children:"Refinements"}),(0,o.jsx)(t.th,{children:"Use case"})]})}),(0,o.jsxs)(t.tbody,{children:[(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.strong,{children:"Full"})}),(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"campaignSchema"})}),(0,o.jsx)(t.td,{children:"Yes"}),(0,o.jsx)(t.td,{children:"Validating complete ATT&CK objects"})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.strong,{children:"Base"})}),(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"campaignBaseSchema"})}),(0,o.jsx)(t.td,{children:"No"}),(0,o.jsxs)(t.td,{children:["Deriving custom schemas via ",(0,o.jsx)(t.code,{children:".partial()"}),", ",(0,o.jsx)(t.code,{children:".pick()"}),", ",(0,o.jsx)(t.code,{children:".omit()"})]})]}),(0,o.jsxs)(t.tr,{children:[(0,o.jsx)(t.td,{children:(0,o.jsx)(t.strong,{children:"Partial"})}),(0,o.jsx)(t.td,{children:(0,o.jsx)(t.code,{children:"campaignPartialSchema"})}),(0,o.jsx)(t.td,{children:"Yes (partial-safe)"}),(0,o.jsx)(t.td,{children:"Validating incomplete or draft objects"})]})]})]}),"\n",(0,o.jsx)(t.h3,{id:"why-base-schemas-exist",children:"Why base schemas exist"}),"\n",(0,o.jsxs)(t.p,{children:["Zod ",(0,o.jsx)(t.a,{href:"https://github.com/colinhacks/zod/releases/tag/v4.3.0",children:"does not allow"})," ",(0,o.jsx)(t.code,{children:".partial()"}),", ",(0,o.jsx)(t.code,{children:".pick()"}),", or ",(0,o.jsx)(t.code,{children:".omit()"})," on schemas that contain refinements,\r\nbecause these operations change the input type and the original refinement may no longer be valid.\r\nBase schemas provide the object shape without refinements, so you can safely derive custom schemas from them."]}),"\n",(0,o.jsxs)(t.p,{children:["See the ",(0,o.jsx)(t.a,{href:"/docs/how-to-guides/schema-variants",children:"Schema Variants"})," how-to guide for practical usage examples."]})]})}function w(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(C,{...e})}):C(e)}}}]);